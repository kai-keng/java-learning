<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>行为型-状态模式 | Java</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="Just record my learning process">
    <link rel="preload" href="/java-learning/assets/css/0.styles.dcc29016.css" as="style"><link rel="preload" href="/java-learning/assets/js/app.ac2a67bc.js" as="script"><link rel="preload" href="/java-learning/assets/js/2.008936f0.js" as="script"><link rel="preload" href="/java-learning/assets/js/23.4fdb08ca.js" as="script"><link rel="prefetch" href="/java-learning/assets/js/10.297963c4.js"><link rel="prefetch" href="/java-learning/assets/js/11.83e1f062.js"><link rel="prefetch" href="/java-learning/assets/js/12.be4ac7de.js"><link rel="prefetch" href="/java-learning/assets/js/13.50f4db4f.js"><link rel="prefetch" href="/java-learning/assets/js/14.1ea833da.js"><link rel="prefetch" href="/java-learning/assets/js/15.543e8433.js"><link rel="prefetch" href="/java-learning/assets/js/16.2ce33a67.js"><link rel="prefetch" href="/java-learning/assets/js/17.1b3dedc1.js"><link rel="prefetch" href="/java-learning/assets/js/18.47d553e2.js"><link rel="prefetch" href="/java-learning/assets/js/19.8fea51c3.js"><link rel="prefetch" href="/java-learning/assets/js/20.edb7a984.js"><link rel="prefetch" href="/java-learning/assets/js/21.caeb796b.js"><link rel="prefetch" href="/java-learning/assets/js/22.5306d23b.js"><link rel="prefetch" href="/java-learning/assets/js/24.acb59804.js"><link rel="prefetch" href="/java-learning/assets/js/25.b39354c7.js"><link rel="prefetch" href="/java-learning/assets/js/26.34744482.js"><link rel="prefetch" href="/java-learning/assets/js/27.9d817416.js"><link rel="prefetch" href="/java-learning/assets/js/28.ce175df3.js"><link rel="prefetch" href="/java-learning/assets/js/29.dddabea2.js"><link rel="prefetch" href="/java-learning/assets/js/3.03089721.js"><link rel="prefetch" href="/java-learning/assets/js/30.b34f1045.js"><link rel="prefetch" href="/java-learning/assets/js/31.20601aec.js"><link rel="prefetch" href="/java-learning/assets/js/32.1926f1e6.js"><link rel="prefetch" href="/java-learning/assets/js/33.f721c816.js"><link rel="prefetch" href="/java-learning/assets/js/34.97dae683.js"><link rel="prefetch" href="/java-learning/assets/js/35.8879bfab.js"><link rel="prefetch" href="/java-learning/assets/js/36.38b317bc.js"><link rel="prefetch" href="/java-learning/assets/js/37.fc694188.js"><link rel="prefetch" href="/java-learning/assets/js/38.a58c0bfc.js"><link rel="prefetch" href="/java-learning/assets/js/39.c660b3d6.js"><link rel="prefetch" href="/java-learning/assets/js/4.3ee03ea7.js"><link rel="prefetch" href="/java-learning/assets/js/40.1a5b1e06.js"><link rel="prefetch" href="/java-learning/assets/js/41.50ad159c.js"><link rel="prefetch" href="/java-learning/assets/js/42.90290904.js"><link rel="prefetch" href="/java-learning/assets/js/43.792193c1.js"><link rel="prefetch" href="/java-learning/assets/js/44.09f3c67e.js"><link rel="prefetch" href="/java-learning/assets/js/45.ef142fe2.js"><link rel="prefetch" href="/java-learning/assets/js/46.8eb12bba.js"><link rel="prefetch" href="/java-learning/assets/js/47.414ea3b9.js"><link rel="prefetch" href="/java-learning/assets/js/48.77647189.js"><link rel="prefetch" href="/java-learning/assets/js/49.d91c693d.js"><link rel="prefetch" href="/java-learning/assets/js/5.7883bb88.js"><link rel="prefetch" href="/java-learning/assets/js/50.7dcc0829.js"><link rel="prefetch" href="/java-learning/assets/js/51.425f52a3.js"><link rel="prefetch" href="/java-learning/assets/js/52.976027e7.js"><link rel="prefetch" href="/java-learning/assets/js/53.4cca20db.js"><link rel="prefetch" href="/java-learning/assets/js/54.ebee06ac.js"><link rel="prefetch" href="/java-learning/assets/js/55.f64789c2.js"><link rel="prefetch" href="/java-learning/assets/js/56.deadf2ad.js"><link rel="prefetch" href="/java-learning/assets/js/57.52a430c2.js"><link rel="prefetch" href="/java-learning/assets/js/58.cca49718.js"><link rel="prefetch" href="/java-learning/assets/js/59.20c3f232.js"><link rel="prefetch" href="/java-learning/assets/js/6.8382b96e.js"><link rel="prefetch" href="/java-learning/assets/js/60.f5b62f2b.js"><link rel="prefetch" href="/java-learning/assets/js/61.e7045df0.js"><link rel="prefetch" href="/java-learning/assets/js/62.afc8f203.js"><link rel="prefetch" href="/java-learning/assets/js/63.70e43f63.js"><link rel="prefetch" href="/java-learning/assets/js/64.11032ac2.js"><link rel="prefetch" href="/java-learning/assets/js/65.bd078e6e.js"><link rel="prefetch" href="/java-learning/assets/js/66.7fd924c8.js"><link rel="prefetch" href="/java-learning/assets/js/67.10634fbc.js"><link rel="prefetch" href="/java-learning/assets/js/68.47c73ce3.js"><link rel="prefetch" href="/java-learning/assets/js/69.346d76e6.js"><link rel="prefetch" href="/java-learning/assets/js/7.7c54cc3a.js"><link rel="prefetch" href="/java-learning/assets/js/70.4eaae357.js"><link rel="prefetch" href="/java-learning/assets/js/71.a9b3301d.js"><link rel="prefetch" href="/java-learning/assets/js/72.435b113d.js"><link rel="prefetch" href="/java-learning/assets/js/73.a452d682.js"><link rel="prefetch" href="/java-learning/assets/js/74.9783a1d9.js"><link rel="prefetch" href="/java-learning/assets/js/75.279971ae.js"><link rel="prefetch" href="/java-learning/assets/js/76.0532b064.js"><link rel="prefetch" href="/java-learning/assets/js/77.bc983f19.js"><link rel="prefetch" href="/java-learning/assets/js/78.697c5452.js"><link rel="prefetch" href="/java-learning/assets/js/79.cb38f138.js"><link rel="prefetch" href="/java-learning/assets/js/8.c8d0de62.js"><link rel="prefetch" href="/java-learning/assets/js/9.6f199a2d.js">
    <link rel="stylesheet" href="/java-learning/assets/css/0.styles.dcc29016.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/java-learning/" class="home-link router-link-active"><!----> <span class="site-name">Java</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://kai-keng.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://kai-keng.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/spring-boot/" class="sidebar-heading clickable"><span>Spring Boot</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/spring-cloud/" class="sidebar-link">Spring Cloud</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/spring-security/" class="sidebar-heading clickable"><span>Spring Security</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/mysql/" class="sidebar-heading clickable"><span>MySQL</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/collection/" class="sidebar-heading clickable"><span>集合框架</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/jvm/" class="sidebar-heading clickable"><span>JVM</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/multi-thread/" class="sidebar-heading clickable"><span>多线程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/design-pattern/" class="sidebar-heading clickable router-link-active open"><span>设计模式</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-learning/design-pattern/singleton.html" class="sidebar-link">创建型-单例模式</a></li><li><a href="/java-learning/design-pattern/templateMethod.html" class="sidebar-link">行为型-模板方法模式</a></li><li><a href="/java-learning/design-pattern/state.html" aria-current="page" class="active sidebar-link">行为型-状态模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java-learning/design-pattern/state.html#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/java-learning/design-pattern/state.html#理解" class="sidebar-link">理解</a></li><li class="sidebar-sub-header"><a href="/java-learning/design-pattern/state.html#优点" class="sidebar-link">优点</a></li><li class="sidebar-sub-header"><a href="/java-learning/design-pattern/state.html#缺点" class="sidebar-link">缺点</a></li><li class="sidebar-sub-header"><a href="/java-learning/design-pattern/state.html#示例" class="sidebar-link">示例</a></li><li class="sidebar-sub-header"><a href="/java-learning/design-pattern/state.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/java-learning/design-pattern/builder.html" class="sidebar-link">创建型-建造者模式</a></li><li><a href="/java-learning/design-pattern/prototype.html" class="sidebar-link">创建型-原型模式</a></li><li><a href="/java-learning/design-pattern/flyweight.html" class="sidebar-link">结构型-享元模式</a></li><li><a href="/java-learning/design-pattern/proxy.html" class="sidebar-link">结构型-代理模式</a></li><li><a href="/java-learning/design-pattern/observer.html" class="sidebar-link">行为型-观察者模式</a></li><li><a href="/java-learning/design-pattern/factory.html" class="sidebar-link">创建型-工厂模式</a></li><li><a href="/java-learning/design-pattern/strategy.html" class="sidebar-link">行为型-策略模式</a></li><li><a href="/java-learning/design-pattern/adapter.html" class="sidebar-link">结构型-适配器模式</a></li><li><a href="/java-learning/design-pattern/command.html" class="sidebar-link">行为型-命令模式</a></li><li><a href="/java-learning/design-pattern/decorator.html" class="sidebar-link">结构型-装饰器模式</a></li><li><a href="/java-learning/design-pattern/facade.html" class="sidebar-link">结构型-外观模式</a></li><li><a href="/java-learning/design-pattern/bridge.html" class="sidebar-link">结构型-桥接模式</a></li><li><a href="/java-learning/design-pattern/responsibility.html" class="sidebar-link">行为型-责任链模式</a></li></ul></section></li><li><a href="/java-learning/internet/" class="sidebar-link">网络</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/other/" class="sidebar-heading clickable"><span>其他</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/materials/" class="sidebar-link">相关资料</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="行为型-状态模式"><a href="#行为型-状态模式" class="header-anchor">#</a> 行为型-状态模式</h1> <h2 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h2> <p>对有状态的对象，把复杂的“判断逻辑”提取到不同的状态对象中，允许状态对象在其内部状态发生改变时改变其行为。</p> <h2 id="理解"><a href="#理解" class="header-anchor">#</a> 理解</h2> <p>当一个对象拥有多种状态，同时状态会改变对象的行为，不同状态下同一行为结果不同的情况下，就可以使用状态模式。若不使用状态模式的话，则需要用很多的if else去判断，不同的情况再去做不同的操作，这样代码耦合度非常的高，而且当我们需要新增状态的时候，我们还得去改动if else，违反了开闭原则。</p> <h2 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h2> <ul><li>将不同的状态分别写成不同的类，符合单一职责原则。</li> <li>轻耦合，如果新增状态的话只需要新增状态类即可，不违反开闭原则</li></ul> <h2 id="缺点"><a href="#缺点" class="header-anchor">#</a> 缺点</h2> <ul><li>容易多出很多的类</li> <li>实现复杂，如果没有实现好则容易把代码搞得混乱</li></ul> <h2 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h2> <p>Java中多线程拥有很多不同的状态，线程可以在不同的状态之间转换，且不同的状态都有不同的行为。使用状态模式模拟Java多线程状态类的切换。
<img src="data:image/gif;base64,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" alt="线程状态转换图"></p> <p><strong>实现抽象状态类</strong></p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractState</span> <span class="token punctuation">{</span>

    <span class="token keyword">protected</span> <span class="token class-name">Context</span> ctx<span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token class-name">String</span> stateName<span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token class-name">AbstractState</span><span class="token punctuation">(</span><span class="token class-name">Context</span> ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ctx <span class="token operator">=</span> ctx<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token class-name">AbstractState</span><span class="token punctuation">(</span><span class="token class-name">AbstractState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ctx <span class="token operator">=</span> state<span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;状态切换失败----&gt;非法的切换操作&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;状态切换失败----&gt;非法的切换操作&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCpuTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;状态切换失败----&gt;非法的切换操作&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">suspend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;状态切换失败----&gt;非法的切换操作&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;状态切换失败----&gt;非法的切换操作&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>实现外层状态包装类</strong></p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token keyword">class</span> <span class="token class-name">Context</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">AbstractState</span> state<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> ctxName<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token class-name">String</span> ctxName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NewState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ctxName <span class="token operator">=</span> ctxName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCpuTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state<span class="token punctuation">.</span><span class="token function">getCpuTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">suspend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state<span class="token punctuation">.</span><span class="token function">suspend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>实现具体的状态类</strong></p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">NewState</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractState</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">NewState</span><span class="token punctuation">(</span><span class="token class-name">AbstractState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;新建&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">NewState</span><span class="token punctuation">(</span><span class="token class-name">Context</span> ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;新建&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ReadyState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;----新建----&gt;就绪----&gt;状态切换成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">ReadyState</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractState</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">ReadyState</span><span class="token punctuation">(</span><span class="token class-name">AbstractState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;就绪&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">ReadyState</span><span class="token punctuation">(</span><span class="token class-name">Context</span> ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;就绪&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCpuTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RunningState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;----就绪----&gt;运行----&gt;状态切换成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">RunningState</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractState</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">RunningState</span><span class="token punctuation">(</span><span class="token class-name">AbstractState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;运行&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">RunningState</span><span class="token punctuation">(</span><span class="token class-name">Context</span> ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;运行&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">suspend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LockState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;----运行----&gt;阻塞----&gt;状态切换成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeadState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;----运行----&gt;死亡----&gt;状态切换成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">LockState</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractState</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">LockState</span><span class="token punctuation">(</span><span class="token class-name">AbstractState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;阻塞&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">LockState</span><span class="token punctuation">(</span><span class="token class-name">Context</span> ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;阻塞&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ReadyState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getCtxName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;----阻塞----&gt;就绪----&gt;状态切换成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">DeadState</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractState</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">DeadState</span><span class="token punctuation">(</span><span class="token class-name">AbstractState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;死亡&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">DeadState</span><span class="token punctuation">(</span><span class="token class-name">Context</span> ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateName <span class="token operator">=</span> <span class="token string">&quot;死亡&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>测试类</strong></p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Context</span> ctx1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token string">&quot;线程1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Context</span> ctx2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token string">&quot;线程2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;模拟Java多线程状态切换---线程1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx1<span class="token punctuation">.</span><span class="token function">getCpuTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx1<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;模拟Java多线程状态切换---线程2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx2<span class="token punctuation">.</span><span class="token function">getCpuTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx2<span class="token punctuation">.</span><span class="token function">suspend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx2<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx2<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx2<span class="token punctuation">.</span><span class="token function">getCpuTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx2<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>测试结果</strong></p> <div class="language-JAVA extra-class"><pre class="language-java"><code>模拟<span class="token class-name">Java</span>多线程状态切换<span class="token operator">--</span><span class="token operator">-</span>线程<span class="token number">1</span>
线程<span class="token number">1</span><span class="token operator">--</span><span class="token operator">--</span>新建<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>就绪<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>状态切换成功
线程<span class="token number">1</span><span class="token operator">--</span><span class="token operator">--</span>就绪<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>运行<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>状态切换成功
线程<span class="token number">1</span><span class="token operator">--</span><span class="token operator">--</span>运行<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>死亡<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>状态切换成功
线程<span class="token number">1</span>状态切换失败<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>非法的切换操作
模拟<span class="token class-name">Java</span>多线程状态切换<span class="token operator">--</span><span class="token operator">-</span>线程<span class="token number">2</span>
线程<span class="token number">2</span><span class="token operator">--</span><span class="token operator">--</span>新建<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>就绪<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>状态切换成功
线程<span class="token number">2</span><span class="token operator">--</span><span class="token operator">--</span>就绪<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>运行<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>状态切换成功
线程<span class="token number">2</span><span class="token operator">--</span><span class="token operator">--</span>运行<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>阻塞<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>状态切换成功
线程<span class="token number">2</span><span class="token operator">--</span><span class="token operator">--</span>阻塞<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>就绪<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>状态切换成功
线程<span class="token number">2</span>状态切换失败<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>非法的切换操作
线程<span class="token number">2</span><span class="token operator">--</span><span class="token operator">--</span>就绪<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>运行<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>状态切换成功
线程<span class="token number">2</span><span class="token operator">--</span><span class="token operator">--</span>运行<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>死亡<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>状态切换成功
</code></pre></div><h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>状态模式可以让状态切换变得很简单，用组合的方式拼装包装类与状态，使代码解耦，并且让拓展变得简单，方便新增新的状态。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/java-learning/design-pattern/templateMethod.html" class="prev">
        行为型-模板方法模式
      </a></span> <span class="next"><a href="/java-learning/design-pattern/builder.html">
        创建型-建造者模式
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/java-learning/assets/js/app.ac2a67bc.js" defer></script><script src="/java-learning/assets/js/2.008936f0.js" defer></script><script src="/java-learning/assets/js/23.4fdb08ca.js" defer></script>
  </body>
</html>
